%\documentclass[10pt,journal,compsoc, a4paper]{IEEEtran}
\documentclass[10pt,a4paper,twocolumn]{article}

%for links
%\usepackage[hidelinks]{hyperref}
\usepackage{hyperref}

%for bilbiography
\usepackage{natbib}

%for images
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\author{Dionisio Perez-Mavrogenis}
\title{Firmware Protection and Attacks Against the ATmega Microcontrollers}
\date{\today}

\begin{document}
	\maketitle
	
\section*{\emph{Abstract}}
	\textbf{\emph{The most abstract abstract of some abstracts, full of abstractions.}}
	

\input{introduction.tex}
\input{atmega_specs.tex}

\section{Attacks on Hardware}
\label{sec:curr_attacks}
A distinction between \emph{passive} and \emph{active} attacks should be made. In the former the attacker simply monitors the chip's normal operation and tries to infer the input-output mapping whereas in the latter case the attacker actively manipulates either the chip or its operating environment with the aim of obtaining insight on the chips inner workings. 

Attacks on MCUs may attempt to recover a number of artefacts, including cryptographic keys the firmware and do not need to necessarily attack the hardware itself but can exploit flaws in algorithmic design and implementation and protocol failures or inter-component communication patterns\citep{anderson:cautionary_note}\citep{kocher:DPA}, obtain information by corrupting the memory or exploiting memory remanence\citep{sergei:thesis}\citep{gutman:memory_remanence}.

	\subsection{Non-Invasive Attacks}
	Non-invasive attacks are attacks which require no de-packaging or special preparation of the chip and hence attacks under this category leave little tamper evidence behind. These attacks might be very time consuming and are not guaranteed to be successful, but are very easy and cheap to replicate once found. Furthermore, non-invasive attacks could target badly implemented communication or security protocols in order to bypass security restrictions.
	
	\subsubsection{Power Analysis}
	\label{subsubsec:power_analysis}
	Different instructions executing on a CPU require different amounts of power, and hence one can infer which instruction is executing on a CPU by analysing a power trace generated by the MCU. These attacks are easy and relatively inexpensive to perform as they only require widely available tools.
	
	Simple Power Analysis(SPA) involves direct observation of the MCU when it performs cryptographic operations and can leak information about both the keys and the cryptographic operations themselves (i.e. nature or structure of the algorithm). 

	Differential Power Analysis(DPA) extracts sensitive information by using statistical techniques on very large traces. The techniques involves obtaining power traces of known cipher-texts(but not necessarily knowing the cipher-texts) and individual bits of the key are recovered by analysing the differences in power consumption\citep{kocher:DPA}.
	
	One can generally avoid noise in their power measurements by sampling the voltage (usually) on the ground line.
	\subsubsection{Glitch Attacks}
	\emph{Power glitches} and \emph{clock glitches} aim to make the CPU skip or execute incorrect instructions by applying transients. This attack can target in individual components of an MCU and a systematic search can deduce which components are affected by a given glitch sequence.
	
	Clock glitches involve increasing the clock signal frequency so that some flip flops sample their input before being updated and hence report an incorrect value. Clock glitches are mainly aimed against software-based protection mechanisms, affecting CPU operation by supplying the CPU with incorrect data.
	
	Power glitches work by supplying either too much power or too little, shifting transistors' threshold and causing flip-flops to read their state incorrectly. Power glitches need to be carefully synchronised with the internal clock and prolonged attacks might damage the board.
	
	\subsubsection{Data Remanence}
	Prolonged exposure of SRAM cells to the same values can make the cells 'remember' their state, due to material properties and stress\citep{gutman:memory_remanence}. If for example a start-up routine always writes security keys to the same memory region, after some time they key will be recoverable by looking at the physical state of the memory. Furthermore, data can be recovered from SRAM  by cooling it down for a period of time after power is removed.
	
	EEPROM suffers as well, but to a lesser extent, as material-wise one can only tell virgin-cells from used cells\citep{sergei:thesis}. 
	\subsubsection{Timing Attacks}
	Timing attacks exploit the software implementation of cryptographic algorithms. Compiler optimisations (avoiding unnecessary branches, register and cache usage) and other implementation choices make the execution time of an algorithm dependent on the input and the secret key, rather being fixed for any input. For example, when input is compared byte-wise with a key and rejected when the first non-matching byte is found, rather than first consuming the whole input string.
	
	Different instructions take different time to execute(e.g. \texttt{MOV eax,[eax]} is considerably slower than \texttt{INC eax}) and thus one could collect timing information for various input messages and systematically deduce the correct key. 
	
	If timing information is correlated with power analysis then defences such as constant instruction execution time could be defeated. One might use \texttt{NOP}s in the case of a wrong key in order for rejection and confirmation responses to have constant execution time but \texttt{NOP} consumes substantially less power than \texttt{INC eax} and correlating timing and power consumption information would reveal this.

	\subsection{Semi-Invasive Attacks}
	some sort of fault injection?
		all memory types are linear( as well as memory mapped IO) - related to memory scanning attacks by glitching and power faults (stop making call or jump instructions)
	
	\subsection{Invasive Attacks}
	Invasive attacks require direct access to the board's surface and as a result destroy the packaging in the process, therefore leaving tamper evidence. Invasive attacks usually aim to understand how a board functions and then develop cheaper attacks for that chip, as invasive attacks are laborious, require expensive equipment and highly skilled attackers and usually are carried out in a number of stages.
	
	The first stage is exposing the chip surface. Usually this involves (partially or completely) destroying the packaging with any means necessary, i.e. by using chemicals or drilling. While this is a process that is not very complicated\citep{sergei:thesis}, one might have trouble finding the chemicals required. An alternative approach is to send the chip to a failure analysis lab for de-caping\citep{website:hacking_the_pic}.
	
	overview of attack categories [each one to the category that it corresponds above]
	\begin{itemize}
		\item microprobing \\
		\item reverse engineering of hardware\\
	\end{itemize}
	
	* for each category discuss budget/tools/skillset/time required\\

\input{countermeasures.tex}
\input{attacking_the_atmega.tex}
\input{evaluation.tex}
	
	\bibliographystyle{plain}
	\bibliography{irp_report}	
	
\end{document}
